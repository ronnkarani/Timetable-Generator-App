{% extends 'base.html' %}
{% block content %}
<h1>💼 Classes</h1>

<p>✅ Grouped view of Classes, Streams, Subjects & Teachers.</p>
<p>✅ Add new Classes & their Streams <a href="{% url 'add_class' %}" class="btn-global">➕ Add Class</a></p>

{% for item in class_data %}
  <div class="class-group">
    <h2>🏫 {{ item.class.name }}</h2>

    {% if item.streams_data %}
      {% for sd in item.streams_data %}
        <h3>📌 Stream: {{ sd.stream.name }}</h3>
        {% if sd.assignments %}
          <table>
            <tr>
              <th>Subject</th>
              <th>Teacher</th>
            </tr>
            {% for stt in sd.assignments %}
              <tr>
                <td>{{ stt.subject.name }}</td>
                <td>{{ stt.teacher.name }}</td>
              </tr>
            {% endfor %}
          </table>
        {% else %}
          <p>No subjects assigned for this stream.</p>
        {% endif %}
      {% endfor %}
    {% else %}
      <p>No streams added yet.</p>
    {% endif %}

    <div class="actions">
      <a href="{% url 'view_class' item.class.id %}" class="action-btn view">👁️ View</a>
      <a href="{% url 'edit_class' item.class.id %}" class="action-btn edit">✏️ Edit</a>
      <a href="{% url 'delete_class' item.class.id %}" class="action-btn delete">🗑️ Delete</a>
    </div>
  </div>
  <hr>
{% endfor %}

<!-- Pagination -->
{% if page_obj.has_other_pages %}
<div class="pagination">
  {% if page_obj.has_previous %}
    <a href="?page={{ page_obj.previous_page_number }}">&laquo; Prev</a>
  {% endif %}
  <span>Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>
  {% if page_obj.has_next %}
    <a href="?page={{ page_obj.next_page_number }}">Next &raquo;</a>
  {% endif %}
</div>
{% endif %}

{% endblock %}
