{% extends 'base.html' %}
{% block content %}
<div class="form-container">
    <h1>ğŸ“‹ {{ title }}</h1>

    <form method="POST">
        {% csrf_token %}

        {% if form_type == 'teacher' %}
            <p>ğŸ‘¨â€ğŸ« Edit teacher info and assigned subjects/streams.</p>
            <div class="form-group">
                <label for="{{ form.name.id_for_label }}">Full Name:</label>
                {{ form.name }}
            </div>
            <div class="form-group">
                <label for="{{ form.teacher_id.id_for_label }}">Teacher ID:</label>
                {{ form.teacher_id }}
            </div>

            {% if formset %}
                <h3>ğŸ“š Assigned Subjects & Streams</h3>
                {{ formset.management_form }}
                {% for f in formset %}
                    <div class="stream-form">
                        {{ f.stream.label_tag }} {{ f.stream }}
                        {{ f.subject.label_tag }} {{ f.subject }}
                        {% if f.instance.pk %}
                            {{ f.DELETE }} Delete
                        {% endif %}
                    </div>
                {% endfor %}
            {% endif %}


            {% elif form_type == 'class' %}
            <p>ğŸ« Add/Edit a class and its streams below.</p>

            <div class="form-group">
                <label for="{{ form.name.id_for_label }}">Class Name:</label>
                {{ form.name }}
            </div>

            <!-- Streams -->
            {% if formset %}
            <h3>ğŸ§© Streams</h3>
            {{ formset.management_form }}
            {% for f in formset %}
                <div class="stream-form">
                    {{ f.name.label_tag }} {{ f.name }}
                    {% if f.instance.pk %}
                        {{ f.DELETE }} Delete
                    {% endif %}
                </div>
            {% endfor %}
            {% endif %}

            <!-- Subjects & Teachers per Stream -->
            {% if stream_assignment_formsets %}
            <h3>ğŸ“š Subjects & Teachers per Stream</h3>
            {% for stream, fs in stream_assignment_formsets %}
                <h4>Stream: {{ stream.name }}</h4>
                {{ fs.management_form }}
                {% for f in fs %}
                    <div class="assignment-form">
                        {{ f.subject.label_tag }} {{ f.subject }}
                        {{ f.teacher.label_tag }} {{ f.teacher }}
                        {% if f.instance.pk %}
                            {{ f.DELETE }} Delete
                        {% endif %}
                    </div>
                {% endfor %}
                <hr>
            {% endfor %}
            {% endif %}



        
            {% elif form_type == 'assignment' %}
            <p>ğŸ—‚ï¸ Assign a teacher to a subject and stream.</p>
            <div class="form-group">
                <label for="{{ form.stream.id_for_label }}">Select Stream:</label>
                {{ form.stream }}
            </div>
            <div class="form-group">
                <label for="{{ form.subject.id_for_label }}">Select Subject:</label>
                {{ form.subject }}
            </div>
            <div class="form-group">
                <label for="{{ form.teacher.id_for_label }}">Select Teacher:</label>
                {{ form.teacher }}
            </div>

        {% elif form_type == 'subject' %}
            <p>ğŸ“˜ Add a new subject taught in school.</p>
            <div class="form-group">
                <label for="{{ form.name.id_for_label }}">Subject Name:</label>
                {{ form.name }}
            </div>

        {% else %}
            {{ form.as_p }}
        {% endif %}

        <button type="submit" class="btn">Save</button>
    </form>
</div>
{% endblock %}
